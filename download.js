
// ==UserScript==
// @name         加密获取下载地址
// @namespace    http://tampermonkey.net/
// @version      1.0.1
// @description  捕获请求头和负载，并重新发送请求，生成带密码保护的悬浮下载按钮，密码输入用 * 号显示
// @match        *://rmt.jxrtv.com:82/*
// @grant        GM_xmlhttpRequest
// @grant        GM_addStyle
// @updateURL    https://raw.githubusercontent.com/yanchenur/test/new/download.js
// @downloadURL  https://raw.githubusercontent.com/yanchenur/test/new/download.js
// ==/UserScript==

function _0x3175(_0x2d0e25,_0x54fabb){const _0x2d682e=_0x2d68();return _0x3175=function(_0x31754a,_0x591211){_0x31754a=_0x31754a-0x1bd;let _0x5ea4fa=_0x2d682e[_0x31754a];return _0x5ea4fa;},_0x3175(_0x2d0e25,_0x54fabb);}function _0x2d68(){const _0x3f77ae=['20BEEePb','fileTypeId','apply','streamMediaPath','files','509719OdTXaq','input','parse','_requestMethod','2049972pogQtR','5750ZaHUix','forEach','_requestHeaders','length','22031aqCWYG','Request\x20Error:','password-overlay','open','charCodeAt','body','fromCharCode','HDV','1986Hompzr','addEventListener','floating-download-button','321530kmTbGs','slice','password-input','responseText','setRequestHeader','isArray','请输入下载密码','className','href','275GAlJre','Failed\x20to\x20parse\x20response\x20JSON:','\u0088\u0089\u008c_cegdjf','prototype','div','createElement','密码错误，无法下载。','textContent','05051234','type','removeChild','_requestUrl','substring','placeholder','send','resourcesList','join','appendChild','stringify','_requestData','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.floating-download-button\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#007bff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x208px\x20rgba(0,\x200,\x200,\x200.2);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.floating-download-button:hover\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#0056b3;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','1010756ZxLqwM','button','password','SDV','onclick','value','44100QPhPwb','map','1208ARLzlM'];_0x2d68=function(){return _0x3f77ae;};return _0x2d68();}(function(_0x3773e7,_0x4453af){const _0x1b57b1=_0x3175,_0x4ad770=_0x3773e7();while(!![]){try{const _0x212d1b=parseInt(_0x1b57b1(0x1bf))/0x1*(parseInt(_0x1b57b1(0x1f1))/0x2)+parseInt(_0x1b57b1(0x1fa))/0x3+-parseInt(_0x1b57b1(0x1e8))/0x4+-parseInt(_0x1b57b1(0x1fb))/0x5*(parseInt(_0x1b57b1(0x1c7))/0x6)+parseInt(_0x1b57b1(0x1f6))/0x7+parseInt(_0x1b57b1(0x1f0))/0x8*(-parseInt(_0x1b57b1(0x1ee))/0x9)+parseInt(_0x1b57b1(0x1ca))/0xa*(parseInt(_0x1b57b1(0x1d3))/0xb);if(_0x212d1b===_0x4453af)break;else _0x4ad770['push'](_0x4ad770['shift']());}catch(_0x29939b){_0x4ad770['push'](_0x4ad770['shift']());}}}(_0x2d68,0x635fd),(function(){'use strict';const _0x464c8a=_0x3175;let _0x529b72={},_0x3cac59=null,_0x23b19e=null,_0x3e46e3=null;const _0x2e0a1e=_0x464c8a(0x1db),_0x40a59a=_0x464c8a(0x1d5);function _0xad77f8(_0x4a59ee,_0x1899d1){const _0x3725e0=_0x464c8a,_0xe97bec=_0x1899d1[_0x3725e0(0x1be)];return Array['from'](_0x4a59ee)[_0x3725e0(0x1ef)]((_0x2459f2,_0x3fc822)=>String[_0x3725e0(0x1c5)](_0x2459f2['charCodeAt'](0x0)+_0x1899d1[_0x3725e0(0x1c3)](_0x3fc822%_0xe97bec)))[_0x3725e0(0x1e3)]('');}function _0x42e41a(_0x5ddf55){const _0x23a2aa=_0x464c8a,_0x5227e0=_0xad77f8(_0x5ddf55,_0x2e0a1e),_0xdfe10=_0x5227e0[_0x23a2aa(0x1df)](0x1);return _0xdfe10===_0x40a59a;}const _0x1a31e1=XMLHttpRequest['prototype']['open'],_0x26ced2=XMLHttpRequest[_0x464c8a(0x1d6)][_0x464c8a(0x1e1)];XMLHttpRequest[_0x464c8a(0x1d6)][_0x464c8a(0x1c2)]=function(_0x380698,_0x355bf5){const _0x2dab1b=_0x464c8a;this[_0x2dab1b(0x1f9)]=_0x380698,this[_0x2dab1b(0x1de)]=_0x355bf5,this[_0x2dab1b(0x1bd)]={};const _0x3ce628=this[_0x2dab1b(0x1ce)];this['setRequestHeader']=function(_0x32a2d3,_0x2040f8){const _0x45d1c9=_0x2dab1b;this[_0x45d1c9(0x1bd)][_0x32a2d3]=_0x2040f8,_0x3ce628[_0x45d1c9(0x1f3)](this,arguments);},this[_0x2dab1b(0x1c8)]('load',function(){const _0x10659f=_0x2dab1b;this[_0x10659f(0x1de)]['includes']('/resourcemanagerservice/api/resource/get')&&(_0x23b19e=this[_0x10659f(0x1de)],_0x3e46e3=this['_requestMethod'],_0x529b72=this[_0x10659f(0x1bd)],_0x3cac59=this[_0x10659f(0x1e6)]?JSON[_0x10659f(0x1f8)](this[_0x10659f(0x1e6)]):null,_0x3fbf7a());}),_0x1a31e1[_0x2dab1b(0x1f3)](this,arguments);},XMLHttpRequest['prototype']['send']=function(_0x56d34b){const _0x54fe58=_0x464c8a;this[_0x54fe58(0x1e6)]=_0x56d34b,_0x26ced2['apply'](this,arguments);};function _0x3fbf7a(){const _0x27e9ff=_0x464c8a;if(!_0x23b19e||!_0x3cac59)return;GM_xmlhttpRequest({'method':_0x3e46e3,'url':_0x23b19e,'headers':_0x529b72,'data':JSON[_0x27e9ff(0x1e5)](_0x3cac59),'onload':function(_0x324d97){const _0x55703e=_0x27e9ff;try{const _0x5e9060=JSON['parse'](_0x324d97[_0x55703e(0x1cd)]);_0x244221(_0x5e9060);}catch(_0x5acf85){console['error'](_0x55703e(0x1d4),_0x5acf85);}},'onerror':function(_0x5deeda){const _0x176f78=_0x27e9ff;console['error'](_0x176f78(0x1c0),_0x5deeda);}});}function _0x244221(_0x49ae9e){const _0x12665f=_0x464c8a;_0x49ae9e['resourcesList']&&Array[_0x12665f(0x1cf)](_0x49ae9e[_0x12665f(0x1e2)])&&_0x49ae9e[_0x12665f(0x1e2)][_0x12665f(0x1fc)](_0x55ba86=>{const _0x2562d3=_0x12665f;_0x55ba86['files']&&Array['isArray'](_0x55ba86[_0x2562d3(0x1f5)])&&_0x55ba86[_0x2562d3(0x1f5)][_0x2562d3(0x1fc)](_0x414772=>{const _0x4936af=_0x2562d3;if(_0x414772[_0x4936af(0x1f2)]===_0x4936af(0x1eb)||_0x414772[_0x4936af(0x1f2)]===_0x4936af(0x1c6)){let _0x28d1f5=_0x414772[_0x4936af(0x1f4)];_0x28d1f5['endsWith']('/')&&(_0x28d1f5=_0x28d1f5[_0x4936af(0x1cb)](0x0,-0x1));const _0x492517=_0x28d1f5+'/'+_0x414772['fileName'];_0x56994c(_0x492517);}});});}function _0x56994c(_0x4ffe86){const _0x360d4d=_0x464c8a,_0x218037=document[_0x360d4d(0x1d8)](_0x360d4d(0x1e9));_0x218037[_0x360d4d(0x1da)]='下载',_0x218037[_0x360d4d(0x1d1)]=_0x360d4d(0x1c9),_0x218037[_0x360d4d(0x1ec)]=function(){_0x279987(_0x4ffe86);},GM_addStyle(_0x360d4d(0x1e7)),document[_0x360d4d(0x1c4)][_0x360d4d(0x1e4)](_0x218037);}function _0x279987(_0x3519d1){const _0x1e702d=_0x464c8a,_0x19d2d8=document[_0x1e702d(0x1d8)](_0x1e702d(0x1d7)),_0x29a1f9=document['createElement'](_0x1e702d(0x1d7)),_0x223247=document[_0x1e702d(0x1d8)](_0x1e702d(0x1f7)),_0x5dc0c3=document[_0x1e702d(0x1d8)](_0x1e702d(0x1e9)),_0x59f260=document['createElement'](_0x1e702d(0x1e9));_0x19d2d8[_0x1e702d(0x1d1)]=_0x1e702d(0x1c1),_0x29a1f9[_0x1e702d(0x1d1)]='password-prompt',_0x223247[_0x1e702d(0x1dc)]=_0x1e702d(0x1ea),_0x223247[_0x1e702d(0x1e0)]=_0x1e702d(0x1d0),_0x223247[_0x1e702d(0x1d1)]=_0x1e702d(0x1cc),_0x5dc0c3['textContent']='确定',_0x59f260[_0x1e702d(0x1da)]='取消',_0x5dc0c3['onclick']=function(){const _0x40e0f1=_0x1e702d;_0x42e41a(_0x223247[_0x40e0f1(0x1ed)])?(window['location'][_0x40e0f1(0x1d2)]=_0x3519d1,document[_0x40e0f1(0x1c4)][_0x40e0f1(0x1dd)](_0x19d2d8)):alert(_0x40e0f1(0x1d9));},_0x59f260[_0x1e702d(0x1ec)]=function(){const _0x385e4f=_0x1e702d;document['body'][_0x385e4f(0x1dd)](_0x19d2d8);},_0x29a1f9[_0x1e702d(0x1e4)](_0x223247),_0x29a1f9['appendChild'](_0x5dc0c3),_0x29a1f9[_0x1e702d(0x1e4)](_0x59f260),_0x19d2d8[_0x1e702d(0x1e4)](_0x29a1f9),document[_0x1e702d(0x1c4)][_0x1e702d(0x1e4)](_0x19d2d8),GM_addStyle('\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-overlay\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20height:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20rgba(0,\x200,\x200,\x200.5);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x201001;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-prompt\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x208px\x20rgba(0,\x200,\x200,\x200.2);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20max-width:\x20300px;\x20/*\x20限制最大宽度\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-input\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x20/*\x20调整字体大小\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2010px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x20calc(100%\x20-\x2022px);\x20/*\x20调整宽度以适应最大宽度\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-prompt\x20button\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x208px\x2016px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-prompt\x20button:hover\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#007bff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.password-prompt\x20button:active\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#0056b3;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20');}}()));
